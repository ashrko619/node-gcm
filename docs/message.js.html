<!DOCTYPE html>

<html>
<head>
  <title>Message</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
      <ul id="jump_to">
        <li>
          <a class="large" href="javascript:void(0);">Jump To &hellip;</a>
          <a class="small" href="javascript:void(0);">+</a>
          <div id="jump_wrapper">
          <div id="jump_page_wrapper">
            <div id="jump_page">
              
                
                <a class="source" href="message.js.html">
                  message.js.md
                </a>
              
                
                <a class="source" href="sender.js.html">
                  sender.js.md
                </a>
              
            </div>
          </div>
        </li>
      </ul>
    
    <ul class="sections">
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              <h1 id="message">Message</h1>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">var</span> gcm = <span class="hljs-built_in">require</span>(<span class="hljs-string">"gcm"</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-2">&#182;</a>
              </div>
              <p>A message contains the data that is sent to the Android device.
It is constructed with an options object, which can contain any of the given keys.
All of the keys are optional.
If no object is passed, it is the same as passing no keys.</p>
<p>See the <a href="https://developer.android.com/google/gcm/server-ref.html#table1">GCM server reference</a> for details on some of the options.</p>
<ul>
<li><code>collapseKey</code> identifies a group of messages that can be collapsed.
If you send several notifications with the same notification key to a device that is offline, it will only show the most recent when it comes back online.</li>
<li>When <code>delayWhileIdle</code> is set to <code>true</code>, it indicates that the message should not be sent until the device becomes active.</li>
<li><code>time_to_live</code> specifies how long (in seconds) the message should be kept in GCM storage if the device is offline.
The maximum time to live supported is 4 weeks (which is also the default).</li>
<li><code>dry_run</code> indicates whether or not this is a test request.
If it is set to <code>true</code> the server responds as it would, but the message is not actually sent.</li>
<li><code>data</code> contains the JSON payload received by the app.</li>
</ul>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-comment">/* No keys set */</span>
<span class="hljs-keyword">var</span> msg = <span class="hljs-keyword">new</span> gcm.Message();

<span class="hljs-comment">/* All keys set */</span>
<span class="hljs-keyword">var</span> msg = <span class="hljs-keyword">new</span> gcm.Message({
  collapseKey: <span class="hljs-string">"new_message"</span>,
  delayWhileIdle: <span class="hljs-literal">true</span>,
  timeToLive: <span class="hljs-number">5</span> * <span class="hljs-number">60</span> * <span class="hljs-number">60</span> * <span class="hljs-number">24</span>, <span class="hljs-comment">// 5 days</span>
  dryRun: <span class="hljs-literal">true</span>,
  data: {
    displayString: <span class="hljs-string">"Hello, world."</span>
  }
});</pre></div></div>
            
        </li>
        
        
        <li id="section-3">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-3">&#182;</a>
              </div>
              <p>The options have to be set on creation, but the payload of the message can be modified later.
There are two ways to add data.
Either key-value, where the key is added (or overwritten) with the given value; or a full-object override.
If you set a whole object, it will replace the current payload.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-comment">/* Key-value adding of data */</span>
msg.addData(<span class="hljs-string">"numberOfBunniesToDisplay"</span>, <span class="hljs-number">13</span>);

<span class="hljs-comment">/* Object-override of data */</span>
msg.addData({
  displayString: <span class="hljs-string">"Goodbye, world."</span>,
  numberOfBunniesToDisplay: <span class="hljs-number">2</span>
});</pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
